has_arch_gpu_intel_pvc = any('arch-intel_gpu_pvc' in T for T in config.sycl_dev_features.values())
if not has_arch_gpu_intel_pvc:
	config.unsupported_features += ['gpu']
else:
	# TRACKER for PVC + igc-dev: https://github.com/intel/llvm/issues/16401
	config.unsupported_features += ['igc-dev']

# ThreadSanitizer is not currently supported for non-spir triples
config.unsupported_features  += ['target-nvidia', 'target-amd']

# TRACKER: https://github.com/intel/llvm/issues/16184
config.unsupported_features += ['gpu-intel-gen12', 'gpu-intel-dg2']

# CMPLRLLVM-64052
config.unsupported_features += ['spirv-backend']

# https://github.com/intel/llvm/issues/16920
config.unsupported_features += ['arch-intel_gpu_bmg_g21']

config.substitutions.append(
    ("%device_tsan_flags", "-Xarch_device -fsanitize=thread")
)

config.substitutions.append(
    (
        "%deflake ",
        os.path.join(os.path.dirname(__file__), "deflake.bash")
        + " 10 ",
    )
)

if "-fsanitize=address" in config.cxx_flags or "-fsanitize=memory" in config.cxx_flags:
    config.unsupported=True
