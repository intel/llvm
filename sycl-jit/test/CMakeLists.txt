set(LIT_SITE_CFG_INPUT "${CMAKE_CURRENT_SOURCE_DIR}/lit.site.cfg.py.in")

set(LIT_SITE_CFG_HEADER "# Autogenerated by CMake from ${LIT_SITE_CFG_INPUT}\n# Do not edit manually!")

# Configure the lit site configuration by replacing variables.
configure_lit_site_cfg(
    "${LIT_SITE_CFG_INPUT}"
    "${CMAKE_CURRENT_BINARY_DIR}/lit.site.cfg.py"

    MAIN_CONFIG
    ${CMAKE_CURRENT_SOURCE_DIR}/lit.cfg.py
)

# Add a target to invoke tests via Ninja/make.
add_lit_testsuite(check-sycl-jit-lit-tests "Running SYCL Fusion lit tests"
    "${CMAKE_CURRENT_BINARY_DIR}"

    DEPENDS
    SYCLKernelJIT
    opt
    FileCheck
)

add_custom_target(check-sycl-jit)
add_dependencies(check-sycl-jit check-sycl-jit-lit-tests)
